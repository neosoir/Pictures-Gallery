!function($){"use strict";$(".bcpg-container").bcpg();var $precargador=$(".precargador"),urledit="?page=bcpg&action=edit&id=",idTable=$("#idTable").val(),marco;$(".modal").modal(),$("select").material_select(),$(".addbcpg").on("click",(function(e){e.preventDefault(),$("#addbcpg").modal("open")}));var $type=$("#type"),type_val=null,$select=$(".select-dropdown"),$selectionCustom=$("#custom"),$selectionCategory=$("#category"),$setCategory=$("#setCategory"),$addItems,marco;"custom"==$type.val()?($selectionCustom.css("display","block"),$selectionCategory.css("display","none"),$setCategory.css("display","none")):"category"==$type.val()&&($selectionCustom.css("display","none"),$selectionCategory.css("display","block"),$setCategory.css("display","block")),$type.on("change",(function(){type_val=$(this).val(),$select.hasClass("invalid")&&($select.removeClass("invalid"),$select.addClass("valid")),"custom"==type_val?($selectionCustom.css("display","block"),$selectionCategory.css("display","none"),$setCategory.css("display","none")):"category"==type_val&&($selectionCustom.css("display","none"),$selectionCategory.css("display","block"),$setCategory.css("display","block"))})),$("#crear-bcpg").on("click",(function(e){e.preventDefault();var $nombre=$("#nombre-bcpg"),nv=$nombre.val();$precargador.css("display","flex"),""==nv?($precargador.css("display","none"),$nombre.hasClass("invalid")||$nombre.addClass("invalid")):null==type_val||""==type_val?($precargador.css("display","none"),$select.hasClass("invalid")||($select.addClass("invalid"),$select.removeClass("valid"))):$.ajax({url:bcpg.url,type:"POST",dataType:"json",data:{action:"bcpg_crud_gallery",nonce:bcpg.seguridad,nombre:nv,type_val:type_val,tipo:"add"},success:function(data){data.result&&(urledit+=data.insert_id,setTimeout((function(){location.href=urledit}),1300))},error:function(d,x,v){console.log(d),console.log(x),console.log(v)}})})),$(document).on("click","[idbcpgedit]",(function(){var id=$(this).attr("idbcpgedit");location.href=urledit+id})),$(document).on("click","[idbcpgremove]",(function(){var id=$(this).attr("idbcpgremove"),$tr=$('tr[data-bcpg="'+id+'"]'),nombre=$tr.find($("td:nth-child(1)")).text();swal({title:"¿Estás seguro que quieres eliminar la galería '"+nombre+"'?",text:"No podrás deshacer esto!",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Si, borrarlo",closeOnConfirm:!1,showLoaderOnConfirm:!0,html:!0},(function(isConfirm){isConfirm&&$.ajax({url:bcpg.url,type:"POST",dataType:"json",data:{action:"bcpg_crud_gallery",nonce:bcpg.seguridad,tipo:"delete",idgal:id},success:function(data){data.result?setTimeout((function(){swal({title:"Borrado",text:"La galería "+nombre+" ha sido eliminado",type:"success",timer:1500}),$tr.css({background:"red",color:"white"}).fadeOut(600),setTimeout((function(){$tr.remove()}),1e3)}),1500):swal({title:"Error",text:"Hubo un error al eliminar la galería, por favor intenta más tarde",type:"error",timer:2e3})},error:function(d,x,v){console.log(d),console.log(x),console.log(v)}})}))})),$("#addItems").on("click",(function(){console.log("hola"),marco?marco.open():(marco=wp.media({title:"Seleccionar esta imagen",button:{text:"Usar esta imagen"},multiple:!0,library:{type:"image"}})).on("select",(function(){var adjuntos=marco.state().get("selection").map((function(adj){return adj.toJSON()})),output=Beziercode.templateItems(adjuntos);$(".bcpg-container").append(output)}))})),$("#columnas").on("change",(function(params){var $this=$(this),valor=parseInt($this.val()),$items=$(".bcpg-item"),$itemsCat=$(".bcpg-carditem");if($items.length){var arrClass=$items.attr("class").split(" "),er=/m[346]/,r=null,col=null;for(var i in arrClass)null!=(r=arrClass[i].match(er))&&(col=r.input);if(null!==col&&$items&&$items.hasClass(col))switch($items.removeClass(col),valor){case 2:$items.addClass("m6");break;case 3:$items.addClass("m4");break;case 4:$items.addClass("m3")}}if($itemsCat.length){var arrClass=$itemsCat.attr("class").split(" "),er=/m[346]/,r=null,col=null;for(var i in arrClass)r=arrClass[i].match(er),console.log(r),null!=r&&(col=r.input);if(null!==col&&$itemsCat&&$itemsCat.hasClass(col))switch($itemsCat.removeClass(col),valor){case 2:$itemsCat.addClass("m6");break;case 3:$itemsCat.addClass("m4");break;case 4:$itemsCat.addClass("m3")}}}))}(jQuery);